# Malware Playbook

**Author:** Gabriel Mumo Samuel  
**Role:** Global Cybersecurity Expert | SOC Leader | AI-in-Security Innovator  

---

## Overview
Malware can cripple organisations and erode trust in your defences. This playbook provides a clear, human-centred roadmap for detecting, investigating, containing, and recovering from malware incidents on endpoints and servers.

---

## Indicators of Compromise (IoCs)
- **Suspicious Processes:** New or unsigned executables running unexpectedly, DLL injections into legitimate processes  
- **Resource Spikes:** Sudden, unexplained CPU, memory, or network usage increases  
- **Known Malware Artefacts:** File hashes, registry entries, or scheduled tasks matching threat-intel feeds  
- **EDR Alerts:** Endpoint Detection & Response tools flagging anomalous behaviour  

---

## Detection Techniques
1. **Endpoint Telemetry**  
   Continuously monitor process creation, file writes, and registry changes via your EDR solution.  
2. **Integrity Monitoring**  
   Watch critical system files and directories for unexpected modifications using file-integrity tools.  
3. **Network Analysis**  
   Inspect outbound connections for abnormal data flows or communications with known command-and-control servers.  
4. **Threat Intelligence Correlation**  
   Cross-reference suspicious hashes and IPs against internal and external intelligence sources.  

---

## Investigation Steps
1. **Isolate the Host**  
   Immediately segment the affected machine to prevent lateral spread.  
2. **Acquire Forensic Images**  
   Capture volatile memory and disk snapshots for offline analysis.  
3. **Analyze Artefacts**  
   - Examine running processes, loaded modules, and scheduled tasks  
   - Review created/modified files and registry keys  
   - Trace network connections to uncover C2 endpoints  
4. **Reconstruct Timeline**  
   Correlate EDR logs, SIEM events, and user activity to map the malware’s entry, execution, and persistence methods.  

---

## Containment & Eradication
- **Quarantine or Rebuild**  
  Decide whether to disinfect in place or rebuild from a known-good image based on severity.  
- **Remove Malware Components**  
  Delete malicious files, disable rogue services, and clear persistence entries.  
- **Patch & Harden**  
  Close the exploited vulnerability, update AV/EDR signatures, and adjust policies to block similar threats.  
- **Deploy YARA & Indicator Rules**  
  Push new detection signatures to your EDR and SIEM to catch variants.  

---

## Recovery
- **Restore from Backup**  
  Validate the integrity of backups before restoring to ensure no residual infection.  
- **Validate System Health**  
  Run full scans and behavioural tests to confirm the host is clean.  
- **Strengthen Controls**  
  Review firewall rules, privilege policies, and endpoint configurations to prevent recurrence.  
- **Debrief & Share Lessons**  
  Host a post-mortem with all stakeholders—IT, security, and leadership—to document findings and update playbooks.  

---

*Last updated: 2022-01-23
